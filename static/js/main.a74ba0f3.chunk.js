(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{178:function(e,a,t){e.exports=t(357)},357:function(e,a,t){"use strict";t.r(a);var n,i=t(0),r=t.n(i),l=t(11),c=t.n(l),d=t(22),u={name:"A SPACE ODYSSEY",links:[{key:"HOME",name:"HOME",url:"/"},{key:"SPACE",name:"SPACE",url:"/space"}]},s=function(){return r.a.createElement("div",{style:{borderRight:"1px solid #ececec",height:"100%"}},r.a.createElement("p",{style:{fontWeight:"bold"}},u.name),u.links.map(function(e){return r.a.createElement(d.a,{key:e.key,to:e.url},r.a.createElement("div",{style:{padding:"16px"}},e.name))}))},o=t(30),p=t(361),m=t(25),f=t(360),E=t(362),h=t(24),y=t(69),_=t(175);!function(e){e[e.SPACE=0]="SPACE",e[e.TYPE=1]="TYPE",e[e.GROUP=2]="GROUP",e[e.GROUPXGROUP=3]="GROUPXGROUP"}(n||(n={}));var v=window.localStorage,b=function(e){var a=function(){var a=v.getItem(n[e]);return a?JSON.parse(a):[]},t=a();return new Proxy(t,{get:function(e,n){return t=a(),Reflect.get(t,n)},set:function(a,i,r){return Reflect.set(t,i,r),v.setItem(n[e],JSON.stringify(t)),!0}})},O=function(e){return{add:function(a){return function(e,a){return b(e).push(a),!0}(e,a)},del:function(a){return function(e,a){var t=b(e),n=t.findIndex(a);return n>-1&&(t.splice(n,1),!0)}(e,a)},update:function(a,t){return function(e,a,t){var n=b(e),i=n.findIndex(a);return i>-1&&(n[i]=t(n[i]),!0)}(e,a,t)},query:function(a){return function(e,a){return b(e).find(a)}(e,a)},list:function(a){return function(e,a){return b(e).filter(a)}(e,a)}}};O.TABLE=n;var g=O,P=function(e){return Math.max.apply(Math,[0].concat(Object(_.a)(g(e).list(function(e){return!0}).map(function(e){return e.id}))))},k=function e(){Object(y.a)(this,e),this.id=e.id,this.alias=""};k.id=P(n.SPACE);var A=function e(){Object(y.a)(this,e),this.id=e.id,this.alias="",this.space_id=0,this.space_alias=""};A.id=P(n.TYPE);var x=function e(){Object(y.a)(this,e),this.id=e.id,this.alias="",this.path="",this.is_root=!1,this.type_id=-1,this.type_alias="",this.space_id=-1,this.space_alias="",this.children=[]};x.id=P(n.GROUP);var j=function e(){Object(y.a)(this,e),this.id=e.id,this.group_id=-1,this.group_alias="",this.link_group_id=-1,this.link_group_alias=""};j.id=P(n.GROUPXGROUP);var C=g(g.TABLE.SPACE),w=p.a.Item,S={labelCol:{span:8},wrapperCol:{span:16}},I=function(){var e=Object(i.useState)([]),a=Object(o.a)(e,2),t=a[0],n=a[1],l=p.a.useForm(),c=Object(o.a)(l,1)[0],u=Object(i.useCallback)(function(){var e;n(C.list(function(a){return!e||a.alias.indexOf(e)>-1}))},[]);Object(i.useEffect)(function(){u()},[u]);var s=Object(i.useCallback)(function(e){var a,t;console.log("values",e),e.id?(a={id:e.id},t=e,C.update(function(e){return a.alias?e.alias===a.alias:!!a.id&&e.id===a.id},function(e){return Object(h.a)({},e,t)})):function(e){var a=new k;a.alias=e,a.id=++k.id,C.add(a),a.id}(e.alias),u()},[u]);return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{flex:1}},r.a.createElement("div",null,r.a.createElement(m.a,{type:"primary",onClick:function(){c.setFieldsValue({alias:"",id:-1})}},"\u65b0\u589e")),r.a.createElement(f.a,{dataSource:t,columns:[{key:"id",dataIndex:"id",title:"ID"},{key:"alias",dataIndex:"alias",title:"ALIAS"},{key:"__op__",render:function(e){return r.a.createElement("div",null,r.a.createElement(m.a,{onClick:function(){var a;a={id:e.id},C.del(function(e){return a.id?e.id===a.id:!!a.alias&&e.alias===a.alias}),u()},type:"dashed"},"\u5220\u9664"),r.a.createElement(m.a,{type:"primary",onClick:function(){c.setFieldsValue(e)}},"\u4fee\u6539"),r.a.createElement(d.a,{to:"/type/".concat(e.id)},r.a.createElement(m.a,null,"\u7f16\u8f91TYPE")))}}]})),r.a.createElement("div",{style:{flex:1}},r.a.createElement("h1",null,"\u7f16\u8f91\u533a"),r.a.createElement(p.a,Object.assign({},S,{form:c,onFinish:s}),r.a.createElement(w,{name:"id",label:"ID",required:!0},r.a.createElement(E.a,{disabled:!0})),r.a.createElement(w,{name:"alias",label:"ALIAS",required:!0},r.a.createElement(E.a,null)),r.a.createElement(m.a,{type:"primary",htmlType:"submit"},"\u4fdd\u5b58"))))},T=g(g.TABLE.GROUP),R=g(g.TABLE.GROUPXGROUP),q=g(g.TABLE.TYPE),L=g(g.TABLE.SPACE),G=function(e){var a=e,t=R.list(function(a){return a.group_id===e.id}).map(function(e){return T.query(function(a){return a.id===e.link_group_id})}).reduce(function(e,a){var t=e[a.type_alias];return t?t.push({id:a.id,alias:a.alias}):e[a.type_alias]=[{id:a.id,alias:a.alias}],e},{});a.links=t},U=function(e){e.space_alias=L.query(function(a){return a.id===e.space_id}).alias,e.type_alias=q.query(function(a){return a.id===e.type_id}).alias},F=function e(a){var t=T.list(function(e){var t=e.path!==a.path,n=e.path.startsWith(a.path),i=/#.*#/.test(e.path.replace(a.path,""));return t&&n&&!i});Array.isArray(t)&&(t.forEach(function(a){U(a),G(a),e(a)}),a.children=t)},B=function(e){var a=Object(h.a)({},new x,e.group);return a.id=++x.id,a.is_root=!e.parentPath,a.path=e.parentPath?"".concat(e.parentPath).concat(a.id,"#"):"ROOT".concat(a.id,"#"),a.space_alias=L.query(function(a){return a.id===e.group.space_id}).alias,a.type_alias=q.query(function(a){return a.id===e.group.type_id}).alias,T.add(a),a.id},D=function(e){var a=T.query(function(a){return e.id?a.id===e.id:e.type_id?a.type_id===e.id:!!e.alias&&a.alias===e.alias});if(a)return T.list(function(e){return e.path.startsWith(a.path)}).forEach(function(e){R.del(function(a){return a.group_id===e.id||a.link_group_id===e.id})}),T.del(function(e){return!e.is_root&&e.path.startsWith(a.path)})},Y=g(g.TABLE.TYPE),V=g(g.TABLE.SPACE),W=p.a.Item,H={labelCol:{span:8},wrapperCol:{span:16}},J=function(){var e=Object(i.useState)([]),a=Object(o.a)(e,2),t=a[0],n=a[1],l=Object(d.c)(),c=p.a.useForm(),u=Object(o.a)(c,1)[0],s=Object(i.useCallback)(function(){var e,a;n((e=+l.space_id,Y.list(function(t){return!(t.space_id!==e)&&(!a||t.alias.indexOf(a)>-1)})))},[l.space_id]);Object(i.useEffect)(function(){s()},[s]);var y=Object(i.useCallback)(function(e){var a,t;console.log("values",e),e.id?(a={id:e.id},t=e,Y.update(function(e){return a.alias?e.alias===a.alias:!!a.id&&e.id===a.id},function(e){return Object(h.a)({},e,t)})):function(e,a){var t=new A;t.space_id=e,t.space_alias=V.query(function(a){return a.id===e}).alias,t.alias=a,t.id=++A.id,Y.add(t);var n=new x;n.space_id=e,n.type_id=t.id,n.alias=a,n.children=[],B({group:n}),t.id}(+l.space_id,e.alias),s()},[l.space_id,s]);return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{flex:1}},r.a.createElement("div",null,r.a.createElement(m.a,{type:"primary",onClick:function(){u.setFieldsValue({alias:"",id:-1})}},"\u65b0\u589e")),r.a.createElement(f.a,{dataSource:t,columns:[{key:"id",dataIndex:"id",title:"ID"},{key:"alias",dataIndex:"alias",title:"ALIAS"},{key:"space_alias",dataIndex:"space_alias",title:"SPACE_ALIAS"},{key:"__op__",render:function(e){return r.a.createElement("div",null,r.a.createElement(m.a,{onClick:function(){!function(e){var a=Y.query(function(a){return e.id?a.id===e.id:!!e.alias&&a.alias===e.alias});if(a)D({type_id:a.id}),Y.del(function(e){return e.id===a.id})}({id:e.id}),s()},type:"dashed"},"\u5220\u9664"),r.a.createElement(m.a,{type:"primary",onClick:function(){u.setFieldsValue(e)}},"\u4fee\u6539"),r.a.createElement(d.a,{to:"/group/".concat(l.space_id,"/").concat(e.id)},r.a.createElement(m.a,null,"\u7f16\u8f91GROUP")))}}]})),r.a.createElement("div",{style:{flex:1}},r.a.createElement("h1",null,"\u7f16\u8f91\u533a"),r.a.createElement(p.a,Object.assign({},H,{form:u,onFinish:y}),r.a.createElement(W,{name:"id",label:"ID",required:!0},r.a.createElement(E.a,{disabled:!0})),r.a.createElement(W,{name:"alias",label:"ALIAS",required:!0},r.a.createElement(E.a,null)),r.a.createElement(m.a,{type:"primary",htmlType:"submit"},"\u4fdd\u5b58"))))},M=t(358),X=t(359),N=t(363),$=p.a.Item,z={labelCol:{span:8},wrapperCol:{span:16}},K=function(){var e=Object(i.useState)([]),a=Object(o.a)(e,2),t=a[0],n=a[1],l=Object(d.c)(),c=p.a.useForm(),u=Object(o.a)(c,1)[0],s=Object(i.useCallback)(function(){var e,a=(e={space_id:+l.space_id,type_id:+l.type_id},T.list(function(a){return e.space_id===a.space_id&&e.type_id===a.type_id&&!!a.is_root&&(!e.kw||a.alias.indexOf(e.kw)>-1)}).map(function(e){return U(e),G(e),F(e),e}));console.log("tree",a),n(a.map(function(e){return function e(a){return a.title=r.a.createElement(M.a,{gutter:16},r.a.createElement(X.a,null,r.a.createElement("div",null,a.alias)),r.a.createElement(X.a,null,r.a.createElement(m.a,{type:"link",onClick:function(e){e.stopPropagation(),D({id:a.id}),s()}},"\u5220\u9664")),r.a.createElement(X.a,null,r.a.createElement(m.a,{type:"link",onClick:function(e){e.stopPropagation(),u.setFieldsValue(a)}},"\u67e5\u770b")),r.a.createElement(X.a,null,r.a.createElement(m.a,{type:"link",onClick:function(e){e.stopPropagation();var t={};t.parentPath=a.path,u.setFieldsValue(t)}},"\u6dfb\u52a0\u5b50\u8282\u70b9"))),a.key=a.path,a.children=Array.isArray(a.children)?a.children.map(function(a){return e(a)}):[],a}(e)}))},[u,l.space_id,l.type_id]);Object(i.useEffect)(function(){s()},[s]);var f=Object(i.useCallback)(function(e){var a,t;console.log("values",e),e.id?(a={id:e.id},t=Object(h.a)({},e,{space_id:+l.space_id,type_id:+l.type_id}),T.update(function(e){return a.alias?e.alias===a.alias:!!a.id&&e.id===a.id},function(e){return Object(h.a)({},e,t)})):B({group:Object(h.a)({},e,{space_id:+l.space_id,type_id:+l.type_id}),parentPath:e.parentPath}),s()},[l.space_id,l.type_id,s]);return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{flex:1}},r.a.createElement(N.a,{autoExpandParent:!0,defaultExpandAll:!0,showLine:!0,treeData:t})),r.a.createElement("div",{style:{flex:1}},r.a.createElement("h1",null,"\u7f16\u8f91\u533a"),r.a.createElement(p.a,Object.assign({},z,{form:u,onFinish:f}),r.a.createElement($,{name:"id",label:"ID",required:!0},r.a.createElement(E.a,{disabled:!0})),r.a.createElement($,{name:"parentPath",label:"PARENT_PATH",required:!0},r.a.createElement(E.a,{disabled:!0})),r.a.createElement($,{name:"path",label:"PATH",required:!0},r.a.createElement(E.a,{disabled:!0})),r.a.createElement($,{name:"alias",label:"ALIAS",required:!0},r.a.createElement(E.a,null)),r.a.createElement(m.a,{type:"primary",htmlType:"submit"},"\u4fdd\u5b58"))))},Q=function(e){return r.a.createElement("div",null,"Home")};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(356);c.a.render(r.a.createElement(function(){return r.a.createElement("div",{style:{height:"100vh",display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{padding:"8px",boxShadow:"0px 0px 12px #cecece"}},r.a.createElement("h2",null,"Access Control Evolved")),r.a.createElement("div",{style:{flex:1,display:"flex",padding:"16px"}},r.a.createElement("div",{style:{width:"200px",height:"100vh"}},r.a.createElement(s,null)),r.a.createElement("div",{style:{height:"100vh",width:"100%",padding:"0 8px"}},r.a.createElement(d.b,null,r.a.createElement(Q,{path:"/"}),r.a.createElement(I,{path:"/space"}),r.a.createElement(J,{path:"/type/:space_id"}),r.a.createElement(K,{path:"/group/:space_id/:type_id"})))))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[178,1,2]]]);
//# sourceMappingURL=main.a74ba0f3.chunk.js.map